<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M13 from src/site/apt/index.apt.vm at 2024-06-23
 | Rendered using Apache Maven Fluido Skin 2.0.0-M8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M13" />
    <meta name="date" content="2024" />
    <title>Orbit Correction Server – Orbit Correction Server</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M8.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>Orbit Correction Server</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-06-23<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0</li>
        <li class="pull-right"><a href="https://github.com/KIT-IBPT/oc-server" target="_blank" class="externalLink">Source repository: https://github.com/KIT-IBPT/oc-server</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li class="active"><a>Overview</a></li>
    <li><a href="development.html">Development Guide</a></li>
    <li><a href="apidocs/index.html">Javadoc</a></li>
   <li class="nav-header">Projects</li>
    <li><a href="https://kit-ibpt.github.io/epics-cs-shell/" class="externalLink">CS-Shell App Server</a></li>
    <li><a href="https://kit-ibpt.github.io/epics-cs-shell-flute/" class="externalLink">CS-Shell-FLUTE App Server</a></li>
    <li><a href="https://kit-ibpt.github.io/oc-server/" class="externalLink">Orbit Correction Server</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-down"></span>Project Information</a>
     <ul class="nav nav-list">
      <li><a href="dependencies.html">Dependencies</a></li>
      <li><a href="dependency-info.html">Dependency Information</a></li>
      <li><a href="distribution-management.html">Distribution Management</a></li>
      <li class="active"><a>About</a></li>
      <li><a href="plugin-management.html">Plugin Management</a></li>
      <li><a href="plugins.html">Plugins</a></li>
      <li><a href="summary.html">Summary</a></li>
     </ul></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<p><b>Contents</b></p>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Server_Runtime_Bundle">Server Runtime Bundle</a>
<ul>
<li><a href="#Startup_Script">Startup Script</a></li>
<li><a href="#The_Application_Server_Initialization_Configuration">The Application Server Initialization Configuration</a></li></ul></li>
<li><a href="#Glossary_of_Terms">Glossary of Terms</a></li></ul><hr /><section>
<h1><a id="Introduction">Introduction</a></h1>
<p>OrbitCorrection server is based on Machine Physics calculation model written in Java. It uses linear beam optics to calculate necessary machine model parameters. It uses SVD to invert response matrix for orbit correction calculation.</p>
<p>OrbitCorrection server can work in &quot;fast&quot; mode in a way that tries to apply orbit correction as frequently as possible, wile doing reasonable compromise on precision. This enables OC to be run during energy ramping and during insertion device activation. </p>
<p>OrbitCorrection server runs embedded EPICS Application server, which exposes API to remote clients. </p><hr /></section><section>
<h1><a id="Server_Runtime_Bundle">Server Runtime Bundle</a></h1>
<p>At <a class="externalLink" href="https://www.ibpt.kit.edu/kara.php">KARA</a> facility OrbitCorrection Server is distributed and run within <a class="externalLink" href="https://kit-ibpt.github.io/epics-cs-shell/">CS-Shell</a> bundle. </p>
<p>Following is directory and file structure of the distribution bundle:</p>
<ul>
<li><code>config</code> - folder containing configuration files for application servers
<ul>
<li><code>bundle.properties</code> - defines home and configuration folders for servers</li>
<li><code>log4j.properties</code> - log4j configuration file</li>
<li><code>FastOC</code> - contains configurations files for OrbitCorrectionServer instance, this particular is optimized for performing fast OC loop.</li>
<li><code>Databush</code> - contains configurations files for core OrbitCorrectionServer machine physics model of accelerator, common to all OC server instances.</li></ul></li>
<li><code>lib</code> - contains libraries, tools and executables, such as Java JAR libraries files, JRE/JDK</li>
<li><code>log</code> - contains log files</li>
<li><code>sh</code> - contains Linux scripts for running servers, there are several OC ser er instances with own configuration</li></ul><section>
<h2><a id="Startup_Script">Startup Script</a></h2>
<p>The application servers finds resources located within the distribution bundle trough runtime configuration in the startup scripts.</p>
<p>The alarm server for example is started by <code>sh/AlarmServer.sh</code> script. The script makes three important declarations</p>
<ul>
<li><code>export AS_NAME=&quot;AlarmServer&quot;</code> - this tells what should be the name of log file. It must be declared before main initialization happens.</li>
<li><code>. &quot;$(dirname &quot;$0&quot;)/_init.sh&quot;</code> - call to the main bundle initialization script which sets up runtime environment variables, such as Java JRE and classpath.</li>
<li><code>$AS_JAVA -classpath $AS_CLASSPATH -Dlog4j.debug=false -DAppServer.init=AppServer-alarms.properties org.scictrl.csshell.epics.server.Server</code> - this line starts the server
<p>The startup line contains following elements:</p></li>
<li><code>$AS_JAVA</code> - is java executable as defined in the <code>_init.sh</code> script,&#xa0;</li>
<li><code>$AS_CLASSPATH</code> - is classpath as defined in the <code>_init.sh</code> script,</li>
<li><code>-DAppServer.init=AppServer-alarms.properties</code> - is name of properties file, which defines initialization properties for the server.</li></ul></section><section>
<h2><a id="The_Application_Server_Initialization_Configuration">The Application Server Initialization Configuration</a></h2><hr /></section></section><section>
<h1><a id="Glossary_of_Terms">Glossary of Terms</a></h1>
<table class="table table-bordered table-striped">
<tr class="a">
<th>Term</th>
<th>Description</th></tr>
<tr class="b">
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Channel Access protocol, part of EPICS</td></tr>
<tr class="a">
<td style="text-align: left;">CAS</td>
<td style="text-align: left;">Java implementation of CA protocol on server side</td></tr>
<tr class="b">
<td style="text-align: left;">CSS BEAST</td>
<td style="text-align: left;">Control system studio implementation of EPICS archiver called BEAST</td></tr>
<tr class="a">
<td style="text-align: left;">OC</td>
<td style="text-align: left;">short for Orbit Correction, which is an algorithm that calculates change of corrector magnets in order to improve electron beam orbit.</td></tr>
<tr class="b">
<td style="text-align: left;">JCA</td>
<td style="text-align: left;">Java implementation of CA protocol on client side</td></tr></table></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2024
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>